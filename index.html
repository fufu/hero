<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<title>比速度，30秒内抓神猿</title>
<meta name="description" content="monkey game for joke..."> 
<meta property="og:type" content="article" />
<meta property="og:url" content="http://i.oslook.com/hero" />
<meta property="og:title" content="无聊的时候想不想打猴子玩？ via oslook.com" />
<meta property="og:description" content="你可以把猴子想象成任何你讨厌或喜欢的人，看看30秒你能点做多少，哈哈，我30秒180下..." />
<meta property="og:image" content="http://picm.bbzhi.com/dongwubizhi/yuanhouxingxing/yuanhouxingxing_76869_m.jpg" />
<script type="text/javascript">
//
/// Download by http://www.oslook.com
//
var ballX,ballY;
var addX,addY;
var intervalId;
var state = 0;
var TIMER_TOTAL = 30000;
var TIMER_INTERVAL = 2000;
var timer_remain = TIMER_TOTAL;

var number =0;
var context ;
var canvas ;
var width;
var height = 600;

var arrColor = [
"#ffdab9",
"#ff4500",
"#ffd700",
"#7b68ee",
"#f5deb3",
"#ff1493"
];

var id = 0;

function catch_ball(ev){
    //alert('catch');
    var x = ev.pageX;
    var y = ev.pageY;
    // get position relative to canvas .
    
    var relativeX = x - document.getElementById("mycanvas").offsetLeft;
    var relativeY = y - document.getElementById("mycanvas").offsetTop;
    
    //judge  whether  clicked  the ball
    if(-5<(relativeX - ballX)&&(relativeX - ballX)<=60){
         if(-5<(relativeY - ballY)&&(relativeY - ballY)<=60){
         	if(state ==1){
            number++;
       		document.getElementById("num").style.color="blue";
       		document.getElementById("num").innerHTML=number;
       		}
        }
    }
}


function windowLoad(){
        
    document.getElementById("mycanvas").onclick = catch_ball;
   	document.getElementById("stop_btn").disabled = "";
  
}

function jump(){
   context.clearRect(0,0,width,height);
   context.save();
   //draw  ball table .
   context.fillStyle = "#485958";
   context.strokeStyle = "#3c3c3c";
   context.lineWidth = 3;
   context.fillRect(3,3,width -6,height-6);
   context.strokeRect(3,3,width-6,height-6);
   
   //draw ball .
   context.beginPath();
   context.fillStyle = "blue";
   context.arc(ballX,ballY,5,0,2*Math.PI,false);

   ballX += addX;
   ballY += addY;
   //alert(ballX+":"+ballY);
   //modify position .
   if(ballX<5){
       ballX = 5;
       addX = -addX;
   }
   
   if(ballY <5){
       ballY = 5;
       addY = -addY;
   }
   
   if(ballX>width-6){
       ballX = width-6;
       addX = -addX;
   }
   
   if(ballY>height-6){
       ballY = height-6;
       addY = -addY;
   }
   
   context.closePath();
   context.fill();
   context.restore(); 
   
}

//random move
function jump_2(){
   context.clearRect(0,0,width,height);
   context.save();
   //draw  ball table .
   //context.fillStyle = "#f06060";
   context.fillStyle =arrColor[id];
   context.lineWidth = 1;
   context.fillRect(1,1,width -2,height-2);
   context.strokeRect(1,1,width-2,height-2);
   
	//draw monkey .
    ballX = parseInt(Math.random()*(width-50));
    ballY = parseInt(Math.random()*(height-50));
	var img=new Image();
	img.src="./monkey.jpg";
	img.onload=function(){
		context.drawImage(img,ballX,ballY);
	};

	timer_remain -= TIMER_INTERVAL;
	document.getElementById("time").style.color="blue";
	document.getElementById("time").innerHTML="00:" + timer_remain/1000;

	if(timer_remain <= 0)
	{
	///	alert('时间到！恭喜你竟然抓到了n只神猿！');
		stopclick();
	}
}



function change(){
id = parseInt(Math.random()*(6));
//console.warn(id);
document.bgColor=arrColor[id];
}

function startclick(){
    //alert('game  start ');
   	change();
    
    number=0;
    timer_remain = TIMER_TOTAL;
    state = 1;
    document.getElementById("myscore").style.fontSize="12px";
    document.getElementById("myscore").innerHTML="";
    document.getElementById("stage").style.visibility='visible';
	canvas = document.getElementById("mycanvas");
    context = canvas.getContext("2d");
  
  	var w=window.innerWidth;
	var h=window.innerHeight;
	if (w>h)w = h;
	
	canvas = document.getElementById("mycanvas");

    canvas.width=w*0.95;
    canvas.height=w*0.95;
      
    width = canvas.width;
    height = canvas.height;
    //alert(height);
    //init  ball init position .
    ballX = parseInt(Math.random()*(width-50));
    ballY = parseInt(Math.random()*(height-50));
    
    addX = -5;
    addY = -5;
    
    jump_2();
    
    intervalId = setInterval("jump_2()",TIMER_INTERVAL);
    document.getElementById("start_btn").disabled = "disabled";
	document.getElementById("stop_btn").disabled = "";
    
}

function stopclick(){
	context.clearRect(0,0,width,height);
	context.save();

	clearInterval(intervalId);
	document.getElementById("start_btn").disabled = "";
	document.getElementById("stop_btn").disabled = "disabled";

	document.getElementById("num").style.color="blue";

	document.getElementById("stage").style.visibility='hidden';
	canvas.width=10;
	canvas.height=10;
	
	document.getElementById("myscore").style.fontSize="45px";
	document.getElementById("myscore").style.color="#4d4d4d";
	document.getElementById("myscore").innerHTML="本次成绩:" + number;

	// Check browser support
	if (typeof(Storage) != "undefined") {
		if(localStorage.getItem("highscore") < number)
		{
			// Store
			localStorage.setItem("highscore", number);
		}
		// Retrieve
		document.getElementById("myscore").innerHTML += "<br>最好成绩:" + localStorage.getItem("highscore");
	} 
}


</script>
</head>
  <body onload="windowLoad();" bgcolor="#f06060">
      <h2 style="color: blue; margin-left: 10px">只想不做，不如抓神猿！<br>30秒能抓几个？</h1>
      <a style="margin-left: 10px" >剩余时间:</a>
      <a id="time">00:30</a>
      <a>，您抓住了</a>
      <a id="num">0</a>
      <a>只猴子！</a>
      <table cellpadding="1">
      <tr>
      <td><input type="button" value="开始抓猴" id="start_btn" onclick="startclick();" style="cursor:pointer;width: 100; height: 30; border-left: 1px solid #85411C; border-right: 1px solid #4E250C; border-top: 1px solid #85411C; border-bottom: 1px solid #4E250C; background-color: #8F431B; color:#FFCC66; font-weight:bold; font-size:14pt;"/></td>
      <td><input type="button" value="神猿太快，不玩了-_-!!" id="stop_btn" onclick="stopclick();" style="cursor:pointer;width: 100; height: 30; border-left: 1px solid #85411C; border-right: 1px solid #4E250C; border-top: 1px solid #85411C; border-bottom: 1px solid #4E250C; background-color: #8F431B; color:#FFCC66; font-weight:bold; font-size:14pt;"/></td> 
      </tr>
      </table>
      <p id="myscore"></p>
      <div id="stage">
          <canvas id="mycanvas"> broswer is not support the game!</canvas>
      </div>

 
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-391361-3', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>