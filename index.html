<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<title>比速度，几秒秒抓神猿</title>
<meta name="description" content="monkey game for joke...">    
<script type="text/javascript">
//
/// Download by http://www.oslook.com
//
var ballX,ballY;
var addX,addY;
var intervalId;
var state = 0;
var TIMER_TOTAL = 30000;
var TIMER_INTERVAL = 2000;
var timer_remain = TIMER_TOTAL;

var number =0;
var context ;
var canvas ;
var width;
var height = 600;


function catch_ball(ev){
    //alert('catch');
    var x = ev.pageX;
    var y = ev.pageY;
    // get position relative to canvas .
    
    var relativeX = x - document.getElementById("mycanvas").offsetLeft;
    var relativeY = y - document.getElementById("mycanvas").offsetTop;
    
    //judge  whether  clicked  the ball
    if(-5<(relativeX - ballX)&&(relativeX - ballX)<=50){
         if(-5<(relativeY - ballY)&&(relativeY - ballY)<=50){
         	if(state ==1){
            number++;
       		document.getElementById("num").style.color="blue";
       		document.getElementById("num").style.fontSize="larger";
       		document.getElementById("num").innerHTML=number;
       		}
        }
    }
}

function windowLoad(){
    document.getElementById("mycanvas").onclick = catch_ball;
   	document.getElementById("stop_btn").disabled = "";
}

function jump(){
   context.clearRect(0,0,width,height);
   context.save();
   //draw  ball table .
   context.fillStyle = "#485958";
   context.strokeStyle = "#3c3c3c";
   context.lineWidth = 3;
   context.fillRect(3,3,width -6,height-6);
   context.strokeRect(3,3,width-6,height-6);
   
   //draw ball .
   context.beginPath();
   context.fillStyle = "blue";
   context.arc(ballX,ballY,5,0,2*Math.PI,false);

   ballX += addX;
   ballY += addY;
   //alert(ballX+":"+ballY);
   //modify position .
   if(ballX<5){
       ballX = 5;
       addX = -addX;
   }
   
   if(ballY <5){
       ballY = 5;
       addY = -addY;
   }
   
   if(ballX>width-6){
       ballX = width-6;
       addX = -addX;
   }
   
   if(ballY>height-6){
       ballY = height-6;
       addY = -addY;
   }
   
   context.closePath();
   context.fill();
   context.restore(); 
   
}

//random move
function jump_2(){
   context.clearRect(0,0,width,height);
   context.save();
   //draw  ball table .
   context.fillStyle = "#f06060";

   context.lineWidth = 1;
   context.fillRect(1,1,width -2,height-2);
   context.strokeRect(1,1,width-2,height-2);
   
	//draw monkey .
    ballX = parseInt(Math.random()*(width-50));
    ballY = parseInt(Math.random()*(height-50));
	var img=new Image();
	img.src="./monkey.jpg";
	img.onload=function(){
		context.drawImage(img,ballX,ballY);
	};

	timer_remain -= TIMER_INTERVAL;
	document.getElementById("time").style.color="blue";
	document.getElementById("time").innerHTML="00:" + timer_remain/1000;

	if(timer_remain <= 0)
	{
	///	alert('时间到！恭喜你竟然抓到了n只神猿！');
		stopclick();
	}
}

function startclick(){
    //alert('game  start ');
    number=0;
    timer_remain = TIMER_TOTAL;
    state = 1;
    document.getElementById("myscore").style.fontSize="12px";
    document.getElementById("myscore").innerHTML="";
    document.getElementById("stage").style.visibility='visible';

    canvas = document.getElementById("mycanvas");
    context = canvas.getContext("2d");
    
    width = canvas.width;
    height = canvas.height;
    //alert(height);
    //init  ball init position .
    ballX = parseInt(Math.random()*(width-50));
    ballY = parseInt(Math.random()*(height-50));
    
    addX = -5;
    addY = -5;
    
    jump_2();
    
    intervalId = setInterval("jump_2()",TIMER_INTERVAL);
    document.getElementById("start_btn").disabled = "disabled";
	document.getElementById("stop_btn").disabled = "";
    
}

function stopclick(){
	context.clearRect(0,0,width,height);
	context.save();

	clearInterval(intervalId);
	document.getElementById("start_btn").disabled = "";
	document.getElementById("stop_btn").disabled = "disabled";

	document.getElementById("num").style.color="blue";
	
document.getElementById("stage").style.visibility='hidden';
document.getElementById("myscore").style.fontSize="120px";
//document.getElementById("myscore").style.fontWeight="120px";
document.getElementById("myscore").style.color="#4d4d4d";
document.getElementById("myscore").innerHTML="score:" + number;
}



</script>
</head>
  <body onload="windowLoad();"  bgcolor="#f06060">
      <h1 style="color: blue; margin-left: 20px">抓神猿，比比30秒能抓几个？</h1>
      <a style="margin-left: 20px" >剩余时间:</a>
      <a id="time">00:30</a>
      <a>，您抓住了</a>
      <a id="num">0</a>
      <a>只猴子！</a>
      <table cellpadding="10">
      <tr>
      <td><input type="button"  value="开始抓猴" id="start_btn" onclick="startclick();" style="cursor:pointer;width: 300; height: 50; border-left: 3px solid #85411C; border-right: 3px solid #4E250C; border-top: 3px solid #85411C; border-bottom: 3px solid #4E250C; background-color: #8F431B; color:#FFCC66; font-weight:bold; font-size:14pt; font-family:微软雅黑"/></td>
      <td><input type="button"  value="神猿太快，不玩了-_-!!" id="stop_btn" onclick="stopclick();" style="cursor:pointer;width: 300; height: 50; border-left: 3px solid #85411C; border-right: 3px solid #4E250C; border-top: 3px solid #85411C; border-bottom: 3px solid #4E250C; background-color: #8F431B; color:#FFCC66; font-weight:bold; font-size:14pt; font-family:微软雅黑"/></td> 
      </tr>
      </table>
      <p id="myscore"></p>
      <div id="stage" width=600px height=600px style="border:#3c3c3c solid 1px;">
          <canvas id="mycanvas" width=600px height=600px > broswer is not support the game!</canvas>
      </div>

 
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-391361-3', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>